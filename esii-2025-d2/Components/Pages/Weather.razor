@page "/Weather"
@inject HttpClient Http
@using esii_2025_d2.Models

<h3>Criar Perfil</h3>

<button class="btn btn-primary" @onclick="SelecionarTalento">Sou Talento</button>
<button class="btn btn-secondary" @onclick="SelecionarCliente">Sou Cliente</button>


@if (tipoSelecionado == "Talent")
{
    <div class="modal">
        <h4>Criar Perfil de Talento</h4>
        <input @bind="novoTalento.Name" placeholder="Nome" />
        <input @bind="novoTalento.Country" placeholder="País" />
        <input type="number" @bind="novoTalento.HourlyRate" placeholder="Preço/Hora" />
        <button @onclick="GuardarTalento">Guardar</button>
    </div>
}
else if (tipoSelecionado == "Customer")
{
    <div class="modal">
        <h4>Criar Perfil de Cliente</h4>
        <input @bind="novoCliente.Company" placeholder="Empresa" />
        <input @bind="novoCliente.PhoneNumber" placeholder="Telefone" />
        <button @onclick="GuardarCliente">Guardar</button>
    </div>
}

@code {
    private string tipoSelecionado = "";

    private Talent novoTalento = new();
    private Customer novoCliente = new();

    private void SelecionarTalento()
    {
        tipoSelecionado = "Talent";
        Console.WriteLine("Sou Talento clicked");
        StateHasChanged();  // Forces a re-render if needed
    }

    private void SelecionarCliente()
    {
        tipoSelecionado = "Customer";
        Console.WriteLine("Sou Cliente clicked");
        StateHasChanged();  // Forces a re-render if needed
    }

    // Métodos para salvar
    async Task GuardarTalento()
    {
        var response = await Http.PostAsJsonAsync("api/Talent", novoTalento);
        if (response.IsSuccessStatusCode)
        {
            // Sucesso!
        }
        else
        {
            // Mostrar erro
        }
    }

    async Task GuardarCliente()
    {
        var response = await Http.PostAsJsonAsync("api/Customer", novoCliente);
        if (response.IsSuccessStatusCode)
        {
            // Sucesso!
        }
        else
        {
            // Mostrar erro
        }
    }
}